!function(){var r;window.Currency=function(t){"use strict";if(r)return r;if(!this||this.constructor!==Currency)return new Currency(t);r=this;var e=this;e.base=t.base,e.current=t.base,e.defaultFormatOptions={mark:".",decimals:0,thousand:" "},e.moneyFormat=wNumb(e.defaultFormatOptions),e.items=t.items,e.factors=t.factors,e.events={update:{}},e.on=function(r,t){e.events[r]&&e.events[r].fn||(e.events[r]={triggered:!1,fn:[]}),e.events[r].fn.push(t)},e.trigger=function(r,t,n){e.events[r]&&e.events[r].fn&&e.events[r].fn.length&&(e.events[r].triggered=!0,e.events[r].fn.forEach(function(r){r.call(e,t,n)}))},e.getCurrent=function(){return this.items[this.current]},e.clearValue=function(r,t){if("number"!=typeof r&&"string"!=typeof r)return"";r=""+r;var e="undefined"!=typeof t&&t.decimals>0?t.mark:"";if(e){var n=r.split(e);return n.map(function(r){return r.replace(/[^\d\.]/g,"")}),n.join(e)}return r=r.replace(/\D/g,""),""!==r&&(r=+r),r},e.toFormatWithClear=function(r,t){t=t||{},t=$.extend(e.defaultFormatOptions,t),r=e.clearValue(r,t);var n=wNumb(t);return""===r||"0"===r?r:n.to(+r)},e.fromFormat=function(r,t){var n=e.moneyFormat;return"object"==typeof t&&(n=wNumb($.extend(e.defaultFormatOptions,t))),""===r?r:n.from(""+r)},e.setRates=function(r){var t;for(t in r)r.hasOwnProperty(t)&&(e.rates[t]=r[t]);return e.rates},e.getRate=function(r){return e.items[r].RATE||console.warn("Empty rate for: "+r),+e.items[r].RATE},e.getCurrentRate=function(){return e.getRate(e.current)},e.setCurrent=function(r,t,n){return e.getRate(r)||console.warn("Empty currency rate for: "+r),e.current!==r&&(e.current=r,t&&(e.updateHtml(),e.updateSelect()),n===!0&&e.saveToStorage(),e.trigger("update")),e.current},e.setBase=function(r){e.base=r},e.convertBaseToCurrent=function(r){return r/e.getCurrentRate()},e.convertToBase=function(r,t){var t=t||e.current;return r*e.getRate(t)},e.convertCurrentToBase=function(r){return e.convertToBase(e.current,r)},e.saveToStorage=function(){localStorage.setItem("currency",e.current)},e.getFromStorage=function(){return localStorage.getItem("currency")},e.setFromStorage=function(r){var t=e.getFromStorage();return"string"==typeof t&&e.items[t]||(t=e.base),t!==e.current&&e.setCurrent(t,r),t},e.setCurrentFactor=function(r){e.getCurrent().FACTOR=r,e.updateHtml(),e.trigger("update")},e.getCurrentFactor=function(){return e.getCurrent().FACTOR},e.getFactor=function(r){return"undefined"==typeof r&&(r=e.current),e.items[r].FACTOR},e.getFactorData=function(r){return"undefined"==typeof r&&(r=e.current),e.factors[e.items[r].FACTOR]},e.getFactorValue=function(r){return"undefined"==typeof r&&(r=e.current),e.getFactorData(r)?+e.getFactorData(r).VALUE:1},e.convertToCurrencyFactor=function(r,t){var t=t||e.current;return r/e.getFactorValue(t)},e.convertFromCurrencyFactor=function(r,t){return r*t},e.convertToCurrentWithFactor=function(r,t){var t=t||e.current;return e.convertBaseToCurrent(e.convertToCurrencyFactor(r,t))},e.convertFromCurrencyWithFactor=function(r,t,n){var t=t||e.current;return e.convertToBase(e.convertFromCurrencyFactor(r,n),t)},e.updateHtmlCurrency=function(r){var r=r||$("[data-currency-base], [data-currency-icon]");r.each(function(){if($(this).data("currency")!==e.current&&!$(this).data("currency-fixed")){var r=+$(this).data("currency-base");r&&$(this).html(e.moneyFormat.to(e.convertBaseToCurrent(r))),"undefined"!==$(this).data("currency-icon")&&($(this).attr("data-icon-position","N"!==e.items[e.current].SHOW_AFTER?"after":"before"),$(this).attr("data-currency-icon",e.items[e.current].SIGN)),$(this).attr("data-currency",e.current),$(this).data("currency",e.current)}})},e.updateCurrencyFactorName=function(r){var r=r||$("[data-currency-factor]"),t=e.getFactorData().TEXT;r.html(t?", "+t:"")},e.updateHtml=function(r){var r=r||$("body");e.updateHtmlCurrency(r.find("[data-currency-base], [data-currency-icon]")),e.updateCurrencyFactorName()},e.initSelect=function(){e.$currencyDropdown=$(".header-currency-dropdown"),e.$currencyDropdownOpenBth=e.$currencyDropdown.find(".js-open-dropdown"),e.closeDropdown=function(){e.$currencyDropdown.removeClass("_open")},e.$currencyDropdown.find(".js-citrus-arealty-currency").on("click",function(){if(!$(this).hasClass("_active")){var r=$(this).find("[data-currency]").data("currency");e.setCurrent(r,!0,!0),e.closeDropdown()}}),e.$currencyDropdownOpenBth.on("click",function(){e.$currencyDropdown.toggleClass("_open")}),e.updateSelect=function(){e.updateHtmlCurrency(e.$currencyDropdown.find("[data-currency-icon]"));var r=e.$currencyDropdown.find('[data-currency="'+e.current+'"]'),t=r.closest(".js-citrus-arealty-currency");t.hasClass("_active")||t.attr("aria-selected","true").addClass("_active").siblings().removeClass("_active").attr("aria-selected","false")},cui.clickOff(e.$currencyDropdown,e.closeDropdown)},e.setFromStorage(),window.setTimeout(function(){e.initSelect(),e.updateSelect(),BX.onCustomEvent(e,"onCurrencyReady"),window.addEventListener("storage",function(r){"currency"===r.key&&e.setFromStorage(!0)})})}}();